'use strict';

angular.module('weone.Advertisement').controller('advertisementController', ['$scope', '$modal', '$filter','apiService', function ($scope, $modal,$filter,apiService) {


        $scope.createAdvertisement = function () {
            $modal.open({
                templateUrl: '/app/tpls/advertisement/popup/creat-advertisement.html',
                backdrop: 'static',
                windowClass: 'modal',
                size: 'lg',
                controller: 'createADcontroller',
            });
        }

        $scope.deleteConfirmation = function (id) {
            $modal.open({
                templateUrl: '/app/tpls/common/popup/deleteConfirmation.html',
                backdrop: 'static',
                windowClass: 'modal',
                size: 'md',
                controller: 'deleteADcontroller',
                resolve: {
                    id: function () {
                        return id;
                    }
                }
            })
        }

        $scope.openVideo = function (data) {
            $modal.open({
                templateUrl: '/app/tpls/advertisement/popup/open-video.html',
                backdrop: 'static',
                windowClass: 'modal',
                size: 'md',
                controller: 'openVideocontroller',
                resolve: {
                    data: function () {
                        return data;
                    }
                }

            })
        }

        $scope.editAdvertisement = function (data) {
            $modal.open({
                templateUrl: '/app/tpls/advertisement/popup/edit-advertisement.html',
                backdrop: 'static',
                windowClass: 'modal',
                size: 'lg',
                controller: 'editADcontroller',
                resolve: {
                    data: function () {
                        return data;
                    }
                }
            })
        }

        $scope.downloadPdf = function (data) {
              // Date Filter
              var startDate = $filter('date')(data.startDate, "dd-MM-yyyy");
              var endDate = $filter('date')(data.endDate, "dd-MM-yyyy");

              var docDefinition = {
                  content: [
                    {
                      text: 'FULL REPORT : ADV- <'+data.entry_id+'>',
                      alignment:'center',
                      fontSize: 15
                    },
                    {
                      image:'data:image/png;base64,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0p8zAAA552lUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4KPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS42LWMxMzIgNzkuMTU5Mjg0LCAyMDE2LzA0LzE5LTEzOjEzOjQwICAgICAgICAiPgogICA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPgogICAgICA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIgogICAgICAgICAgICB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iCiAgICAgICAgICAgIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIgogICAgICAgICAgICB4bWxuczpzdFJlZj0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlUmVmIyIKICAgICAgICAgICAgeG1sbnM6c3RFdnQ9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZUV2ZW50IyIKICAgICAgICAgICAgeG1sbnM6ZGM9Imh0dHA6Ly9wdXJsLm9yZy9kYy9lbGVtZW50cy8xLjEvIgogICAgICAgICAgICB4bWxuczpwaG90b3Nob3A9Imh0dHA6Ly9ucy5hZG9iZS5jb20vcGhvdG9zaG9wLzEuMC8iCiAgICAgICAgICAgIHhtbG5zOnRpZmY9Imh0dHA6Ly9ucy5hZG9iZS5jb20vdGlmZi8xLjAvIgogICAgICAgICAgICB4bWxuczpleGlmPSJodHRwOi8vbnMuYWRvYmUuY29tL2V4aWYvMS4wLyI+CiAgICAgICAgIDx4bXA6Q3JlYXRvclRvb2w+QWRvYmUgUGhvdG9zaG9wIENDIDIwMTUuNSAoV2luZG93cyk8L3htcDpDcmVhdG9yVG9vbD4KICAgICAgICAgPHhtcDpDcmVhdGVEYXRlPjIwMTYtMTItMjBUMTY6MTI6MjQrMDU6MzA8L3htcDpDcmVhdGVEYXRlPgogICAgICAgICA8eG1wOk1vZGlmeURhdGU+MjAxNi0xMi0yMFQxNjoxNDowNyswNTozMDwveG1wOk1vZGlmeURhdGU+CiAgICAgICAgIDx4bXA6TWV0YWRhdGFEYXRlPjIwMTYtMTItMjBUMTY6MTQ6MDcrMDU6MzA8L3htcDpNZXRhZGF0YURhdGU+CiAgICAgICAgIDx4bXBNTTpJbnN0YW5jZUlEPnhtcC5paWQ6MTU4Zjg3YzAtMzVlMi0yNzRlLWIwMTQtYzllNjM0ZGZhNGFjPC94bXBNTTpJbnN0YW5jZUlEPgogICAgICAgICA8eG1wTU06RG9jdW1lbnRJRD54bXAuZGlkOjAxMDRENTZBMTEzMTExRTY4RDg0RThGRTVCMTU2QkQzPC94bXBNTTpEb2N1bWVudElEPgogICAgICAgICA8eG1wTU06RGVyaXZlZEZyb20gcmRmOnBhcnNlVHlwZT0iUmVzb3VyY2UiPgogICAgICAgICAgICA8c3RSZWY6aW5zdGFuY2VJRD54bXAuaWlkOjAxMDRENTY3MTEzMTExRTY4RDg0RThGRTVCMTU2QkQzPC9zdFJlZjppbnN0YW5jZUlEPgogICAgICAgICAgICA8c3RSZWY6ZG9jdW1lbnRJRD54bXAuZGlkOjAxMDRENTY4MTEzMTExRTY4RDg0RThGRTVCMTU2QkQzPC9zdFJlZjpkb2N1bWVudElEPgogICAgICAgICA8L3htcE1NOkRlcml2ZWRGcm9tPgogICAgICAgICA8eG1wTU06T3JpZ2luYWxEb2N1bWVudElEPnhtcC5kaWQ6MDEwNEQ1NkExMTMxMTFFNjhEODRFOEZFNUIxNTZCRDM8L3htcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD4KICAgICAgICAgPHhtcE1NOkhpc3Rvcnk+CiAgICAgICAgICAgIDxyZGY6U2VxPgogICAgICAgICAgICAgICA8cmRmOmxpIHJkZjpwYXJzZVR5cGU9IlJlc291cmNlIj4KICAgICAgICAgICAgICAgICAgPHN0RXZ0OmFjdGlvbj5zYXZlZDwvc3RFdnQ6YWN0aW9uPgogICAgICAgICAgICAgICAgICA8c3RFdnQ6aW5zdGFuY2VJRD54bXAuaWlkOjE1OGY4N2MwLTM1ZTItMjc0ZS1iMDE0LWM5ZTYzNGRmYTRhYzwvc3RFdnQ6aW5zdGFuY2VJRD4KICAgICAgICAgICAgICAgICAgPHN0RXZ0OndoZW4+MjAxNi0xMi0yMFQxNjoxNDowNyswNTozMDwvc3RFdnQ6d2hlbj4KICAgICAgICAgICAgICAgICAgPHN0RXZ0OnNvZnR3YXJlQWdlbnQ+QWRvYmUgUGhvdG9zaG9wIENDIDIwMTUuNSAoV2luZG93cyk8L3N0RXZ0OnNvZnR3YXJlQWdlbnQ+CiAgICAgICAgICAgICAgICAgIDxzdEV2dDpjaGFuZ2VkPi88L3N0RXZ0OmNoYW5nZWQ+CiAgICAgICAgICAgICAgIDwvcmRmOmxpPgogICAgICAgICAgICA8L3JkZjpTZXE+CiAgICAgICAgIDwveG1wTU06SGlzdG9yeT4KICAgICAgICAgPGRjOmZvcm1hdD5pbWFnZS9wbmc8L2RjOmZvcm1hdD4KICAgICAgICAgPHBob3Rvc2hvcDpDb2xvck1vZGU+MzwvcGhvdG9zaG9wOkNvbG9yTW9kZT4KICAgICAgICAgPHBob3Rvc2hvcDpJQ0NQcm9maWxlPnNSR0IgSUVDNjE5NjYtMi4xPC9waG90b3Nob3A6SUNDUHJvZmlsZT4KICAgICAgICAgPHRpZmY6T3JpZW50YXRpb24+MTwvdGlmZjpPcmllbnRhdGlvbj4KICAgICAgICAgPHRpZmY6WFJlc29sdXRpb24+NzIwMDAwLzEwMDAwPC90aWZmOlhSZXNvbHV0aW9uPgogICAgICAgICA8dGlmZjpZUmVzb2x1dGlvbj43MjAwMDAvMTAwMDA8L3RpZmY6WVJlc29sdXRpb24+CiAgICAgICAgIDx0aWZmOlJlc29sdXRpb25Vbml0PjI8L3RpZmY6UmVzb2x1dGlvblVuaXQ+CiAgICAgICAgIDxleGlmOkNvbG9yU3BhY2U+MTwvZXhpZjpDb2xvclNwYWNlPgogICAgICAgICA8ZXhpZjpQaXhlbFhEaW1lbnNpb24+MjUzPC9leGlmOlBpeGVsWERpbWVuc2lvbj4KICAgICAgICAgPGV4aWY6UGl4ZWxZRGltZW5zaW9uPjU4PC9leGlmOlBpeGVsWURpbWVuc2lvbj4KICAgICAgPC9yZGY6RGVzY3JpcHRpb24+CiAgIDwvcmRmOlJERj4KPC94OnhtcG1ldGE+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgCjw/eHBhY2tldCBlbmQ9InciPz6224DSAAAAIGNIUk0AAHolAACAgwAA+f8AAIDpAAB1MAAA6mAAADqYAAAXb5JfxUYAABQqSURBVHja7J15nBXVlce//ehmbbrZQWQTAoqsOtFE44LGJYJoxA0zuEx0HHWCM3EcYjTijOMyTgwxZnGUqDGOGhAQg8OigihuxF0YRAUSdmTfmrWX+eOcShfFvVW36r3X/Wjq9/nUh6b2d+895/7Ock8V9R/0IAmQAZrr1hho4tuaAWVAd6A10AloB7QE2gOleryJ/t0UaAQU+e5fA1QBe4Gd+u8O3Tbov5uBdfrvCmArsAvYD+zRa/YCu3WrJEWKFBRHHC9X4T0S6KJ/HwG0UcEtU6EtVQXQTP9tlOV7Fem7FQMtHK+pVqHfA1TothvYrkpiK7BGFcQq/fsvwKZ0GKQ4XIW+DLgS6A8cAwxQ4S46RH5LRpVPqTILV+wEFgKLgM+ASaoMUqRo8EJ/LvCrw7ANSoFv6oYymn9Oh0aKhopMQOhTwHfSJkhxOAh9EXBW2hwA9EacjylSNGih7wJ0S5vjr23yN2kzpGjoQn8ch47Dri5wXNoEKQ4HoU9RiwEc6O9IkaJBCX0GOLaA3ulVYEs9v8MRSDJRihQNUuhb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',
                      width: 100,
                      margin: [ 0, -25, 0, 0 ],
                      alignment:'right'
                    },
                    {
                      text: '__________________________________________________________________________________________________',
                      color: '#000',
                      alignment:'center',
                      margin: [ 0, 0, 0, 10 ]
                    },
                    {
                      columns: [
                          {
                            width: 100,
                            text: 'Client Name :',
                            bold: 'true'
                          },
                          {
                            width: 350,
                            text: data.clientName
                          }
                        ]
                    },
                    {
                      columns: [
                          {
                            width: 100,
                            text: 'Adv Name :',
                            bold: 'true'
                          },
                          {
                            width: 350,
                            text: data.advert_sub_title
                          }
                        ]
                    },
                    {
                      columns: [
                          {
                            width: 100,
                            text: 'Adv Url :',
                            bold: 'true'
                          },
                          {
                            width: 350,
                            text: data.advert_url
                          }
                        ]
                    },
                    {
                      columns: [
                          {
                            width: 100,
                            text: 'Date :',
                            bold: 'true'
                          },
                          {
                            width: 55,
                            text: 'Start Date :',
                            fontSize: 10
                          },
                          {
                            width: 65,
                            text: startDate,
                            fontSize: 10
                          },
                          {
                            width: 50,
                            text: 'End Date :',
                            fontSize: 10
                          },
                          {
                            width: 80,
                            text: endDate,
                            fontSize: 10
                          }
                        ]
                    },
                    {
                      text: 'Advertisement Detail',
                      alignment:'left',
                      fontSize: 15,
                      margin: [ 0, 20, 0, -10 ]
                    },
                    {
                      text: '__________________________________________________________________________________________________',
                      color: '#000',
                      alignment:'center',
                      margin: [ 0, 0, 0, 5 ]
                    },
                    {
                      columns: [
                          {
                            width: 120,
                            text: 'Adv Type :',
                            bold: 'true'
                          },
                          {
                            width: 100,
                            text: data.type
                          },
                        ]
                    },
                    {
                      columns: [
                          {
                            width: 120,
                            text: 'Duration :',
                            bold: 'true'
                          },
                          {
                            width: 100,
                            text: data.duration_time
                          },
                          {
                            width: 200,
                            text: 'Number of review :',
                            bold: 'true',
                            margin: [ 80, 0, 0, 0 ]
                          },
                          {
                            width: 100,
                            text: data.number_of_comments.toString()
                          }
                        ]
                    },
                    {
                      columns: [
                          {
                            width: 120,
                            text: 'Complete Views :',
                            bold: 'true'
                          },
                          {
                            width: 100,
                            text: data.number_of_times_complete_viewed.toString()
                          },
                          {
                            width: 200,
                            text: 'Partial Views :',
                            bold: 'true',
                            margin: [ 80, 0, 0, 0 ]
                          },
                          {
                            width: 100,
                            text: data.number_of_times_viewed.toString()
                          }
                        ]
                    },
                    {
                      columns: [
                          {
                            width: 120,
                            text: 'Number of Likes :',
                            bold: 'true'
                          },
                          {
                            width: 100,
                            text: data.number_of_likes.toString()
                          },
                          {
                            width: 200,
                            text: 'Number of Calls :',
                            bold: 'true',
                            margin: [ 80, 0, 0, 0 ]
                          },
                          {
                            width: 100,
                            text: data.analytics.number_of_calls.toString()
                          }
                        ]
                    },
                    {
                      columns: [
                          {
                            width: 120,
                            text: 'Number of Visits :',
                            bold: 'true'
                          },
                          {
                            width: 100,
                            text: data.analytics.number_of_visits.toString()
                          }
                        ]
                    },
                    {
                      text: 'Viewer Detail',
                      alignment:'left',
                      fontSize: 15,
                      margin: [ 0, 20, 0, -10 ]
                    },
                    {
                      text: '__________________________________________________________________________________________________',
                      color: '#000',
                      alignment:'center',
                      margin: [ 0, 0, 0, 5 ]
                    },
                    {
                      columns: [
                          {
                            width: 120,
                            text: 'Gender :',
                            bold: 'true'
                          },
                          {
                            width: 100,
                            text: data.gender
                          },
                          {
                            width: 200,
                            text: 'Max Age :',
                            bold: 'true',
                            margin: [ 80, 0, 0, 0 ]
                          },
                          {
                            width: 100,
                            text: data.age.max_age.toString()
                          }
                        ]
                    },
                    {
                      text: 'Description',
                      alignment:'left',
                      fontSize: 15,
                      margin: [ 0, 20, 0, -10 ]
                    },
                    {
                      text: '__________________________________________________________________________________________________',
                      color: '#000',
                      alignment:'center',
                      margin: [ 0, 0, 0, 5 ]
                    },
                    {
                      text: data.description,
                      alignment:'left',
                      fontSize: 10
                    }
                  ],
                  styles: {
                    header: {
                      bold: true,
                      color: '#000',
                      fontSize: 12,
                      alignment: 'center'
                    }
                  }
                };
                pdfMake.createPdf(docDefinition).download('AddDetail.pdf');
          }

        $scope.viewAdvertisement = function (data) {
            $modal.open({
                templateUrl: '/app/tpls/advertisement/popup/view-advertisement.html',
                backdrop: 'static',
                windowClass: 'modal',
                size: 'md',
                controller: 'viewADcontroller',
                resolve: {
                    advertisement: function () {
                        return data;
                    }
                }
            });
        }

        $scope.data = [];
        $scope.setDefault = function () {
            $scope.limit = 10;
            $scope.skip = 0;
            $scope.totalPage = 0;
            $scope.counter = 0;
            $scope.selectedIndex = 0;
            $scope.getDataFlag = true;
            $scope.currentPage=1;
            $scope.maxSize=4;
            $scope.searchPage=1;
            $scope.loading=false;
        }
        $scope.setDefault();
        $scope.filterOnTabClick = function (number) {
            $scope.selectedIndex = number
            console.log('Filter ', number)
            $scope.skip = $scope.limit * number;
            $scope.init($scope.skip);
        }

        $scope.show = function (status) {
            if (status == 'prev') {
                if ($scope.skip > 0) {
                    $scope.skip -= $scope.limit;
                    //  $scope.getJoinEvents();
                    $scope.init($scope.limit);
                }
            } else if (status == 'next') {
                if (($scope.skip + $scope.data.length) < $scope.counter) {
                    $scope.skip += $scope.data.length;
                    //$scope.getJoinEvents();
                    $scope.init($scope.limit);
                }
            }
            $scope.selectedIndex = $scope.skip / $scope.limit;
        }

       //it will get all the advertisment
      $scope.getAllAdvertisement=function(skip) {
        console.log("skip is ",skip);
          $scope.loading=true;
            apiService.getAdvertisement({
                skip: skip,
                limit: $scope.limit
            }).$promise.then(function (data) {
                if (data.object.count) {
                    $scope.counter = data.object.count;
                    console.log("counter in get all advertisement",$scope.counter);

                }
                retriveAdvertisement(data.object.object);
            }, function (error) {
                console.log("error in get advertisement");
                console.log(error);
            });
        };
        //it will be used to search the advertisment
        $scope.searchAdvertisement = function (skip) {
            $scope.loading=true;
          console.log("skip in search is ",skip);
          console.log("search naem is ",$scope.searchname);
            if ($scope.searchname != '') {
                $scope.getDataFlag = false;
                  console.log("getDataFlag  is ",$scope.getDataFlag);
                apiService.searchAdvertisement({
                    name: $scope.searchname,
                    limit: $scope.limit,
                    skip: skip
                }).$promise.then(function (data) {
                  console.log("length of data is ",data.object.count);
                    if (data.object.count) {
                        $scope.counter = data.object.count;
                        console.log("counter is ",$scope.counter);
                    }
                    retriveAdvertisement(data.object.object);
                }, function (error) {
                    console.log("error in the search advertisement");
                    console.log(error);
                });
            } else {
              console.log("in else part of search",$scope.loading);
                $scope.getDataFlag = true;
                $scope.getAllAdvertisement(0);
                $scope.currentPage=1;
                $scope.searchPage=1;
                $scope.skip=0;
            }
        }
        //it common method to retrive the advertisement for seach and get
        function retriveAdvertisement(advertdata) {
            $scope.data = [];
            if(advertdata.length>0){
            console.log("Main Advrt data is..", advertdata);
            console.log("total number of ad", advertdata.length);
            var totalAdvert = advertdata.length;
            for (var i = 0; i < totalAdvert; i++) {
                var tempObject = {};
                tempObject.name = advertdata[i].name_of_advert;
                tempObject._id = advertdata[i]._id;
                tempObject.startDate = new Date(advertdata[i].schedule.start_date);
                tempObject.endDate = new Date(advertdata[i].schedule.end_date);
                tempObject.type = advertdata[i].advert_type;
                tempObject.clientName = advertdata[i].client_details.name;
                tempObject.clientId = advertdata[i].client_details._id;
                tempObject.status = advertdata[i].advert_status;
                tempObject.mediaFileName = advertdata[i].fileInformation.fileName
                tempObject.number_of_comments = advertdata[i].number_of_comments
                tempObject.number_of_likes = advertdata[i].number_of_likes
                tempObject.advert_url = advertdata[i].advert_url
                tempObject.custom_thmbnail = advertdata[i].custom_thmbnail
                tempObject.number_of_times_viewed = advertdata[i].number_of_times_viewed
                tempObject.number_of_times_complete_viewed = advertdata[i].number_of_times_complete_viewed
                tempObject.number_of_times_link_clicked = advertdata[i].number_of_times_link_clicked
                tempObject.gender = advertdata[i].gender;
                if (advertdata[i].custom_thmbnail)
                    tempObject.thumbnail = advertdata[i].custom_thmbnail;
                else if (advertdata[i].thumbnail) {
                    tempObject.thumbnail = advertdata[i].thumbnail
                } else
                    tempObject.thumbnail = 'assets/images/img_video.png';

                tempObject.age = advertdata[i].age_group;
                tempObject.description = advertdata[i].description;
                tempObject.availablity_locality = advertdata[i].availablity_locality;
                tempObject.marital = advertdata[i].marital;
                tempObject.cost_per_click = advertdata[i].cost_per_click;
                if (advertdata[i].fileInformation.duration_time) {
                    var time = (advertdata[i].fileInformation.duration_time / 60).toFixed(2);
                    tempObject.duration_time = time;
                } else
                    tempObject.duration_time = 'N/A'
                tempObject.cost_per_view = advertdata[i].cost_per_view;
                tempObject.advert_url = advertdata[i].advert_url;
                tempObject.advert_sub_title = advertdata[i].advert_sub_title;
                tempObject.smil_file_name = advertdata[i].smil_file_name;
                tempObject.analytics=advertdata[i].analytics;
                tempObject.entry_id=advertdata[i].fileInformation.entry_id;
                $scope.data.push(tempObject);
            }
            console.log(" $scope.data is..", $scope.data);
            if ($scope.data.length != 0) {

                $scope.totalPage = Math.ceil($scope.counter / $scope.limit)*10;
                console.log('qwj ', $scope.totalPage);
                  $scope.loading=false;
            }
          }else {
            $scope.data.length=0;
              $scope.loading=false;
          }
        }
        $scope.init = function (skip) {
          //  $scope.skip = skip;
          console.log("in init funciton",$scope.getDataFlag,skip);
          console.log("filter value is",$scope.filter_val);
            $scope.filter_val = "default";
        if ($scope.getDataFlag == true) {
                $scope.getAllAdvertisement(skip);
              }
            //  else {
            //     $scope.searchAdvertisement(skip);
            // }
        }

        $scope.getFilterType = function(filter_val){
          console.log("the value is",filter_val);
          $scope.sortType = filter_val
        }

        $scope.init(0);
        $scope.pageChangedInAdvertDetails=function(){
          if($scope.getDataFlag==true){
            console.log("page changed in advert ",$scope.getDataFlag);

      $scope.skip=($scope.currentPage-1)*$scope.limit;
      console.log("skip us ",$scope.skip);
        $scope.getAllAdvertisement($scope.skip);
      }else {
        console.log("page changed in advert else part with search");
        $scope.skip=($scope.searchPage-1)*$scope.limit;

        $scope.searchAdvertisement($scope.skip);
      }
        }
        $scope.changeShowRecordAdvertDetails = function () {
            $scope.skip = 0;
            // $scope.selectedIndex = 0
            console.log("limit value", $scope.limitValue)
            $scope.limit = $scope.limitValue;
            $scope.getAllAdvertisement(0);
            $scope.currentPage=1;
        }


}]).controller("editADcontroller", ["$scope", "$modalInstance", "data", '$modal', '$timeout', 'apiService', "$state", "createURLService", "Upload", "$enviornment", "$uploadImage", function ($scope, $modalInstance, data, $modal, $timeout, apiService, $state, createURLService, Upload, $enviornment, $uploadImage) {

    $scope.minAdvStartDate = new Date();
        console.log("edit ad controller called", data);
        $scope.advert = {};
        $scope.minStartDate=new Date();
        $scope.advert.advert_id = data._id;
        $scope.advert.availablity_locality = {};
        $scope.advert.client_details = {};
        $scope.advert.schedule = {};
        $scope.advert.age_group = {};
        $scope.advert.age_group.max_age = data.age.max_age;
        $scope.advert.age_group.min_age = data.age.min_age;
        $scope.advert.client_details.name = data.clientName;
        $scope.advert.client_details._id = data.clientId;
        $scope.custom_thmbnail = data.custom_thmbnail;
        $scope.advert.advert_type = data.type;
        $scope.advert.name_of_advert = data.name;
        $scope.advert.schedule.start_date = data.startDate;
        $scope.advert.schedule.end_date = data.endDate;
        $scope.advert.gender = data.gender;
        $scope.advert.description = data.description;
        $scope.advert.marital = data.marital;
        $scope.advert.cost_per_click = data.cost_per_click;
        $scope.advert.cost_per_view = data.cost_per_view;
        $scope.advert.advert_sub_title = data.advert_sub_title;
        $scope.advert.advert_url = data.advert_url;
        $scope.advert.availablity_locality.radius = data.availablity_locality.radius;
        $scope.advert.availablity_locality.latitude = Number(data.availablity_locality.latitude);
        $scope.advert.availablity_locality.longitude = Number(data.availablity_locality.longitude);
        $scope.radius = Number(data.availablity_locality.radius);
        $scope.loglat = 'Log:' + $scope.advert.availablity_locality.longitude + '    Lat:' + $scope.advert.availablity_locality.latitude;
        // DatePicker
        $scope.$watch('advert.schedule.start_date', function (v) {
            if (v) {
                var hour = new Date().getHours();
                var min = new Date().getMinutes();
                try {
                    v.setHours(0);
                    v.setMinutes(min);
                } catch (e) {}
            }
            $scope.minEndDate = v;

        });
        $scope.$watch('advert.schedule.end_date', function (v) {
            if (v) {
                var hour = new Date().getHours();
                var min = new Date().getMinutes();
                try {
                    v.setHours(0);
                    v.setMinutes(0);
                } catch (e) {}
            }
            $scope.maxStartDate = v;
        });

        $scope.openStart = function () {
            $timeout(function () {
                $scope.startOpened = true;
            });
        };

        $scope.openEnd = function () {
            $timeout(function () {
                $scope.endOpened = true;
            });
        };

        $scope.dateOptions = {
            'year-format': "'yy'",
            'starting-day': 1
        };

        $scope.ok = function () {

            $modalInstance.close();
        };

        $scope.cancel = function () {
            $modalInstance.dismiss();
        };


         //it is the confirmation of upload the video or not
        $scope.updateMediaPopup = function (result) {
            $modal.open({
                templateUrl: '/app/tpls/advertisement/popup/editMediaFile.html',
                backdrop: 'static',
                windowClass: 'modal',
                size: 'md',
                controller: 'updtateMediaController',
                resolve: {
                    data: function () {
                        return result;
                    }
                }
            })
        }


        //  it will open the google map
        $scope.viewMap = function () {
            var viewMap = $modal.open({
                templateUrl: '/app/tpls/common/popup/googleMap.html',
                controller: "googlemapController",
                size: 'lg',
                backdrop: 'static',
                resolve: {
                    latitude: function () {
                        return $scope.advert.availablity_locality.latitude;
                    },
                    longitude: function () {
                        return $scope.advert.availablity_locality.longitude;
                    },
                    radius: function () {
                        return $scope.radius;
                    }
                }
            });
            //set latitude and longitute
            viewMap.result.then(function (data) {
                console.log(data);
                $scope.advert.availablity_locality.radius = data.radius;
                $scope.advert.availablity_locality.longitude = data.latitude;
                $scope.advert.availablity_locality.latitude = data.longitude;
                $scope.loglat = 'Log:' + data.longitude + '    Lat:' + data.latitude;
            }, function () {
                console.log("cancel button called");
            });

        };

        //  it will open the google map
        $scope.clientViewMap = function () {
            var clientViewMap = $modal.open({
                templateUrl: '/app/tpls/common/popup/googleMap.html',
                controller: "googlemapController",
                size: 'lg',
                backdrop: 'static',
                resolve: {
                    latitude: function () {
                        return $scope.advert.availablity_locality.latitude;
                    },
                    longitude: function () {
                        return $scope.advert.availablity_locality.longitude;
                    },
                    radius: function () {
                        return $scope.radius;
                    }
                }
            });
            //set latitude and longitute
            clientViewMap.result.then(function (data) {
                console.log(data);
                $scope.advert.availablity_locality.radius = data.radius;
                $scope.advert.availablity_locality.longitude = data.latitude;
                $scope.advert.availablity_locality.latitude = data.longitude;
                $scope.clientloglat = 'Log:' + data.longitude + '    Lat:' + data.latitude;
            }, function () {
                console.log("cancel button called");
            });

        };

        //thumbnail upload
        $scope.uploadFiles = function (file, errFiles) {
            console.log('control in the upload thmbnail');
            var fileUploadObj = $uploadImage.uploadFiles(file, errFiles);
            fileUploadObj.then(function (response) {
                file.result = response.data;
                console.log(" service url", response.data.object);
                $scope.custom_thmbnail = response.data.object
            }, function (response) {}, function (evt) {});
        }

       //it will update the advertisment
        $scope.updateAdvertisement = function (valid) {
            $scope.submitted = true;
            console.log("update method", valid);
            if (valid) {
                if ($scope.custom_thmbnail)
                    $scope.advert.custom_thmbnail = $scope.custom_thmbnail;
                else
                    $scope.advert.custom_thmbnail = null;
                apiService.editAdvertisement({
                    advert: $scope.advert,
                    advertid: data._id
                }).$promise.then(function (result) {
                    console.log("updated sucessfully", result);
                    $scope.updatedAdvert = result
                    $scope.updateMediaPopup($scope.updatedAdvert)
                }, function (error) {
                    console.log("error in edit advertisement");
                });
                $state.go($state.current, {}, {
                    reload: true
                });
                $modalInstance.close();
            }
        }
}])
    .controller('updtateMediaController', ['$scope', '$modal', "$modalInstance", "data", "apiService", "createURLService", function ($scope, $modal, $modalInstance, data, apiService, createURLService) {
        //it will create the video upload token
        $scope.updateMediaFile = function () {
            apiService.editAdvertMedia({
                "videoToken": {
                    "name_of_advert": data.object.name_of_advert,
                    "advert_type": data.object.advert_type,
                    "advert_id": data.object._id
                }
            }).$promise.then(function (result) {
                createURLService.createURLForVideo(result);
            }, function (error) {
                console.log("error in edit advertisement");
            });
            $modalInstance.close();
        }
        $scope.cancel = function () {
            $modalInstance.dismiss();
        };

}])
    .controller('viewADcontroller', ['$scope', '$modal', "$modalInstance", "advertisement", function ($scope, $modal, $modalInstance, advertisement) {
        //console.log("advertisement view",advertisement);
        $scope.type = advertisement.type;
        $scope.name = advertisement.name;
        $scope.clientName = advertisement.clientName;
        $scope.startDate = advertisement.startDate
        $scope.endDate = advertisement.endDate;
        $scope.gender = advertisement.gender
        $scope.description = advertisement.description
        $scope.age = advertisement.age;
        $scope.duration_time = advertisement.duration_time;
        $scope.thumbnail = advertisement.thumbnail;
        $scope.number_of_comments = advertisement.number_of_comments
        $scope.number_of_likes = advertisement.number_of_likes
        $scope.advert_url = advertisement.advert_url
        $scope.number_of_times_viewed = advertisement.number_of_times_viewed
        $scope.number_of_times_complete_viewed = advertisement.number_of_times_complete_viewed
        $scope.advertisement_id = advertisement._id;
        $scope.number_of_calls=advertisement.analytics.number_of_calls;
        $scope.number_of_visits=advertisement.analytics.number_of_visits;
        //$scope.number_of_times_link_clicked


        $scope.cancel = function () {
            $modalInstance.dismiss();
        };
        $scope.userComment = function () {
            $modal.open({
                templateUrl: '/app/tpls/advertisement/popup/user-comment.html',
                backdrop: 'static',
                windowClass: 'modal',
                size: 'md',
                controller: 'userCommentController',
                resolve: {
                    advertisement_id: function () {
                        return $scope.advertisement_id;
                    }
                }
            })
        }


        $scope.userMap = function () {
          var advert={};
          advert._id=advertisement._id;
          advert.number_of_times_viewed=advertisement.number_of_times_viewed;
            $modal.open({
                templateUrl: '/app/tpls/advertisement/popup/user-map.html',
                backdrop: 'static',
                windowClass: 'modal',
                size: 'lg',
                controller: 'userMapController',
                resolve: {
                    advertid: function () {
                        return advert;
                    }
                }
            });
        }

}]).controller('deleteADcontroller', ['$scope', "$modalInstance", "id", "apiService", "$state", function ($scope, $modalInstance, id, apiService, $state) {
        $scope.ok = function () {
            apiService.deleteAdvertisement({
                advertid: id
            }).$promise.then(function (success) {
                console.log("success deleted");
                $state.go($state.current, {}, {
                    reload: true
                });
            }, function (error) {
                console.log('error in the delete advertisement');
            })
            $modalInstance.close();
        };

        $scope.cancel = function () {
            $modalInstance.dismiss();
        };
}]).controller('openVideocontroller', ['$scope', "$modalInstance", "$state", "$sce", "data", function ($scope, $modalInstance, $state, $sce, data) {

        if (data.type == 'Image') {
            $scope.previewImage = data.thumbnail
        } else {
            $scope.name = 'JWPlayer Example';

            $scope.options = {
                type: 'smil',
                image: 'http://example.com/myVideoPoster.jpg'
            };

            $scope.file = $sce.trustAsResourceUrl(data.smil_file_name);
            // The directive waits to fire until the scope
            // associated with 'watch-me' in the directive changes.
            // So we can set that here.
            $scope.watchme = true;
        }
        $scope.cancel = function () {
            $modalInstance.dismiss();
        };
}])



.controller('createADcontroller', ['$scope', '$window', '$location', '$modal', '$timeout', '$modalInstance', '$log', '$fileUploader', "$http",  "$state", "apiService", "Upload", "$uploadImage","$enviornment",function ($scope, $window, $location, $modal, $timeout, $modalInstance, $log, $fileUploader, $http,  $state, apiService, Upload, $uploadImage,$enviornment) {
    $scope.advert = {};
    $scope.advert.availablity_locality = {};
    $scope.advert.client_details = {};
    $scope.advert.schedule = {};
    $scope.advert.age_group = {};
    $scope.continueFlag = false
    $scope.minStartDate=new Date();
    $scope.today = function () {
        $scope.dt = new Date();
    };
    $scope.today();

    $scope.clear = function () {
        $scope.dt = null;
    };


    // DatePicker
    $scope.$watch('advert.schedule.start_date', function (startDate) {
        if (startDate) {
            var hour = new Date().getHours();
            var min = new Date().getMinutes();
            try {
                startDate.setHours(0);
                startDate.setMinutes(0);
            } catch (e) {}
        }
        $scope.minEndDate = startDate;

    });
    $scope.$watch('advert.schedule.end_date', function (endDate) {
        if (endDate) {
            var hour = new Date().getHours();
            var min = new Date().getMinutes();
            try {
                endDate.setHours(0);
                endDate.setMinutes(0);
            } catch (e) {}
        }
        $scope.maxStartDate = endDate;
    });

    $scope.openStart = function () {
        $timeout(function () {
            $scope.startOpened = true;
        });
    };

    $scope.openEnd = function () {
        $timeout(function () {
            $scope.endOpened = true;
        });
    };

    $scope.dateOptions = {
        'year-format': "'yy'",
        'starting-day': 1
    };

    $scope.ok = function () {

        $modalInstance.close();
    };

    $scope.cancel = function () {
        $modalInstance.dismiss();
    };

    //  map


    $scope.latitude = 28.60440654416547;
    $scope.longitude = 77.20373003280338;
    $scope.radius = 2000;
    //it will open the google map
    $scope.viewMap = function () {
        var viewMap = $modal.open({
            templateUrl: '/app/tpls/common/popup/googleMap.html',
            controller: "googlemapController",
            size: 'lg',
            backdrop: 'true',
            resolve: {
                latitude: function () {
                    return $scope.latitude;
                },
                longitude: function () {
                    return $scope.longitude;
                },
                radius: function () {
                    return $scope.radius;
                }
            }
        });
        //it will set the lat and log of map
        viewMap.result.then(function (data) {
            console.log(data);
            $scope.advert.availablity_locality.radius = data.radius;
            $scope.advert.availablity_locality.longitude = data.latitude;
            $scope.advert.availablity_locality.latitude = data.longitude;
            $scope.loglat = 'Log:' + data.longitude + '    Lat:' + data.latitude;
        }, function () {
            console.log("cancel button called");
        });

    };

    //it will open the google map
    $scope.clientViewMap = function () {
        var clientViewMap = $modal.open({
            templateUrl: '/app/tpls/common/popup/googleMap.html',
            controller: "googlemapController",
            size: 'lg',
            backdrop: 'true',
            resolve: {
                latitude: function () {
                    return $scope.latitude;
                },
                longitude: function () {
                    return $scope.longitude;
                },
                radius: function () {
                    return $scope.radius;
                }
            }
        });
        //it will set the lat and log of map
        clientViewMap.result.then(function (data) {
            console.log(data);
            $scope.advert.availablity_locality.radius = data.radius;
            $scope.advert.availablity_locality.longitude = data.latitude;
            $scope.advert.availablity_locality.latitude = data.longitude;
            $scope.clientloglat = 'Log:' + data.longitude + '    Lat:' + data.latitude;
        }, function () {
            console.log("cancel button called");
        });

    };


    //code for upload the advertisement
    $scope.selectedPerson = {};
    $scope.selectedPerson.detail = {};


    //TODO: Must be called from service
    $scope.createURLForVideo = function (advDetails) {
        var URL =$enviornment.videoUploadUrl;
        $scope.videoURL = URL + advDetails.object.advert_type + "/" + advDetails.object.name_of_advert + "/" + advDetails.object.authToken
        var randomnumber = Math.floor((Math.random() * 100) + 1);
        window.open($scope.videoURL, "_blank", 'PopUp' + randomnumber + ',scrollbars=1,menubar=0,resizable=1,width=850,height=500');

        $modalInstance.close();
        /*  $window.open( $scope.videoURL,'C-Sharpcorner','width=500,height=400');*/
        console.log("window opened..");
    }

   //it will save the advertisment
    $scope.saveAdvertisement = function (valid) {
        console.log("start date in angularside...", $scope.advert.schedule.start_date);
        $scope.submitted = true;
        console.log($scope.custom_thmbnail)
        console.log("valid is..", valid);
        if ($scope.selectedPerson.description == undefined || $scope.selectedPerson.description == 'undefined') {
            //alert('person is not exist');
            // $scope.clientFlag = true
            toastr.error("Client is not exist please select existing client", "oops");
        }

        if (valid && $scope.selectedPerson.description) {

            $scope.continueFlag = true
            $scope.advert.client_details.name = $scope.selectedPerson.description.clientName;
            $scope.advert.client_details._id = $scope.selectedPerson.description.id;
            // it will add custom thumbnail
            if ($scope.custom_thmbnail)
                $scope.advert.custom_thmbnail = $scope.custom_thmbnail;

            apiService.createAdvertisement({
                advert: $scope.advert
            }).$promise.then(function (obj) {
                console.log("success", obj);
                if (obj.object._id) {
                    $scope.advertId = obj.object._id;
                    $scope.advertType = obj.object.advert_type
                    $scope.createURLForVideo(obj)
                }
                $state.go($state.current, {}, {
                    reload: true
                });
            }, function (error) {
                console.log("error in creating user");
                console.log(error);
            });


        }
    }

    //upload thubnail image
    $scope.uploadFiles = function (file, errFiles) {
        console.log('control in the upload thmbnail');
        var fileUploadObj = $uploadImage.uploadFiles(file, errFiles);
        fileUploadObj.then(function (response) {
            file.result = response.data;
            console.log(" service url", response.data.object);
            $scope.custom_thmbnail = response.data.object;
            $scope.custom_thmbnail1 = response.data.object;
            console.log($scope.custom_thmbnail);
        }, function (response) {}, function (evt) {});
    }


   //it will get all the  client
    $scope.clientSearch = function () {
        apiService.getUserData({
            role: 'ROLE_CLIENT',
            limit: 0,
            skip: 0
        }).$promise.then(function (response) {
            var totalclient = response.object.object.length;
            console.log("totalclient is...", response.object.object);
            //   console.log("total number of client",totalclient);
            var clientList = []
            for (var i = 0; i < totalclient; i++) {
                var clientObject = {}
                clientObject.clientName = response.object.object[i].name;
                clientObject.id = response.object.object[i]._id;
                clientList.push(clientObject);
            }
            $scope.clientData = clientList;
        }, function (error) {
            console.log("error is..", error);
        });
    }
    $scope.clientSearch();
    // it will localy search the get all the client
    $scope.localSearch = function (str) {
        var matches = [];
        $scope.clientData.forEach(function (person) {
            if ((person.clientName.toLowerCase().indexOf(str.toString().toLowerCase()) >= 0)) {
                matches.push(person);
            }
        });
        return matches;
    };
 }])

 .controller('userCommentController', ['$scope', "$modalInstance","advertisement_id","apiService","$modal", function ($scope, $modalInstance,advertisement_id,apiService,$modal) {

         $scope.cancel = function () {
            $modalInstance.dismiss();
        };
        console.log("the adv id is",advertisement_id);
        $scope.comments = [];
        $scope.noComments = true;
        $scope.isLoading = true;


        $scope.getComments = function () {
          console.log("inside the getComments");
            apiService.getAllComments({advertisement_id:advertisement_id}).$promise.then(function (response) {
                console.log("the response is",response);
                $scope.comments = response.object.comments;
                $scope.isLoading = false;
                console.log("the comments are",$scope.comments);
                if($scope.comments){
                  if($scope.comments.length>0){
                  $scope.noComments = true;
                }else {
                  $scope.noComments = false;
                }
              }else {
                $scope.noComments = false;
              }
            }, function (error) {
                console.log("error is..", error);
            });
        }
        $scope.getComments();

        //  $scope.comments = [
        //    {username:'Roy',usernamedata:'hii i am using weone app',isDeleted:false},
        //    {username:'John',usernamedata:'how r u',isDeleted:false }
        //   ]
        $scope.deleteCommentConfirmation = function(comment) {
            $modal.open({
                templateUrl: '/app/tpls/common/popup/requestDeleteConfirmation.html',
                backdrop: 'static',
                windowClass: 'modal',
                size: 'md',
                controller: 'commentDeleteController',
                resolve: {
                    comment: function () {
                        return comment;
                    }
                }
            })
        }

        $scope.deleteComment = function(comment){
          comment.isDeleted = true;
          console.log("the comment is",comment);
          toastr.success("Comment Deleted");
          var comment_id = comment._id;
          apiService.deleteComment({comment_id:comment_id}).$promise.then(function(response) {
            console.log("the response is",response);
          }, function (error) {
              console.log("error is..", error);
          });
        }

        $scope.ifCommentExists = function(comment){
          return !(comment.isDeleted);
        }

        $scope.commentCount = function(){
        return $scope.comments.filter($scope.ifCommentExists).length;
        }

     }])

     .controller('commentDeleteController', ['$scope', '$modalInstance', 'apiService','comment', function ($scope, $modalInstance, apiService, comment) {
         console.log("inside delete confirm controller modal");

         $scope.deleteComment = function(comment){
           comment.isDeleted = true;
           console.log("the comment is",comment);
           toastr.success("Comment Deleted");
           var comment_id = comment._id;
           apiService.deleteComment({comment_id:comment_id}).$promise.then(function(response) {
             console.log("the response is",response);
           }, function (error) {
               console.log("error is..", error);
           });
         }

         $scope.ok = function () {
           comment.isDeleted = true;
           $scope.deleteComment(comment);
           $modalInstance.dismiss();

         };
         $scope.cancel = function () {
             $modalInstance.dismiss();
         };
     }])

.controller('userMapController', ['$scope','$modal', '$modalInstance', 'advertid', function ($scope, $modal, $modalInstance, advertid) {
    console.log("hhh");
    // console.log("advert id is",advertid);
    $scope.advertid = advertid._id;
    $scope.number_of_times_viewed=advertid.number_of_times_viewed;
    $scope.cancel = function () {
            $modalInstance.dismiss();
        };



}])


.controller('ChartControllermodal', ['$scope', 'apiService', function ($scope,  apiService) {

        $scope.setDefault=function(){
          $scope.skip=0;
          $scope.limit=50;
          $scope.currentPage=1;
          $scope.maxSize=4;
        }
        $scope.setDefault();

    $scope.init = function(advertId,number){
      console.log("the advert id is",advertId);
      $scope.advertId = advertId;
      $scope.number=number;
      $scope.loadDataFromServer(0)
    }


    var cities = [];

    $scope.loadDataFromServer = function (skip) {

        var scoreHistory = [['State', 'Users']];
        console.log("the advert id isaaa",$scope.advertId);

        apiService.getUsersLocationsWithCities({
            advertisement_id: $scope.advertId,
            skip:$scope.skip,
            limit:$scope.limit
        }).$promise.then(function (userLocation) {
          $scope.states = [];
          $scope.scoreHistory = [];
            console.log("total state", userLocation.object.states,userLocation.object.cities)
            cities = userLocation.object.cities;
            $scope.city=cities.length;
            if($scope.skip==0){
            $scope.pageCounter=Math.ceil($scope.number / $scope.limit)*10;
          }
            console.log("pagecounter and counter is",$scope.pageCounter,userLocation.object.states.length);
            for (var i = 0; i < userLocation.object.states.length; i++) {
                if (userLocation.object.states[i]._id != null && userLocation.object.states[i]._id != "") {
                    $scope.scoreHistory.push([userLocation.object.states[i]._id, userLocation.object.states[i].totalusers]);
                    $scope.states.push({
                        state: userLocation.object.states[i]._id,
                        users: userLocation.object.states[i].totalusers
                    });
                }
            }
            console.log("score history is ",$scope.scoreHistory);
            console.log("states are ",$scope.states);
            var sec_map = $scope.states;
            var state_map = {};
            //$scope.states = [];
            $scope.states.forEach(function(state){
              if(state_map[state.state]){
                state_map[state.state] = state_map[state.state] + 1;
              }else {
                state_map[state.state] = 1;
              }
              console.log("the ahjaj",state_map[state.state]);

            })
            $scope.states = [];
            var flag = {};
            sec_map.forEach(function(st){
              if(!flag[st.state]){
                $scope.states.push({
                    state: st.state,
                    users: state_map[st.state]
                });
                flag[st.state] = true;
              }
            })

            var city_map = {};
            var sec_city = userLocation.object.cities;
            userLocation.object.cities.forEach(function(city){
              if(city_map[city.city]){
                city_map[city.city] = city_map[city.city] + 1;
              }else {
                city_map[city.city] = 1;
              }
            })

            $scope.cities = [];
            var city_flag = {};
            sec_city.forEach(function(st){
              if(city_map[st.city]>1){
                var user = ' Users';
              }else {
                var user = ' User';
              }
              if(!city_flag[st.city]){
                $scope.cities.push({
                    city: st.city,
                    desc: city_map[st.city] + user,
                    lat: st.lat,
                    long: st.long
                });
                city_flag[st.city] = true;
              }
            })

            console.log("the final states are",state_map,$scope.states);
            populate_map($scope.cities);
            $scope.scoreHistory = scoreHistory;
        }, function (err) {
            console.log("error in get user location");
            console.log(err);
        })
    };
    $scope.pageChanged=function(){
      $scope.skip=($scope.currentPage-1)*$scope.limit;
    console.log("skip is",$scope.skip);
      $scope.loadDataFromServer($scope.skip);
    }



var populate_map = function(cities){
  // console.log("into the map");
var mapOptions = {
                zoom: 4,
                center: new google.maps.LatLng(25,80),
                mapTypeId: google.maps.MapTypeId.TERRAIN
            }

            $scope.map = new google.maps.Map(document.getElementById('map'), mapOptions);

            $scope.markers = [];

            var infoWindow = new google.maps.InfoWindow();


            var createMarker = function (info){

                var marker = new google.maps.Marker({
                    map: $scope.map,
                    position: new google.maps.LatLng(info.lat, info.long),
                    title: info.city
                });
                marker.content = '<div class="infoWindowContent">' + info.desc + '</div>';

                google.maps.event.addListener(marker, 'click', function(){
                  console.log("on click of marker");
                    infoWindow.setContent('<h2>' + marker.title + '</h2>' + marker.content);
                    infoWindow.open($scope.map, marker);
                });

                $scope.markers.push(marker);
                console.log("markers are ",$scope.markers);

            }
            var i=0;
            console.log("length of cities",cities.length);
            for (i = 0; i < cities.length; i++){
                createMarker(cities[i]);
                console.log("jj",cities[i]);
            }

            $scope.openInfoWindow = function(e, selectedMarker){
              console.log("hello");
                e.preventDefault();
                google.maps.event.trigger(selectedMarker, 'click');
            }
}


}]);
